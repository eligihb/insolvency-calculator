<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>צו שיקום – פרטי טופס ושליחה</title>
  <style>
    body { font-family: Arial, sans-serif; background:#f7f9fc; margin:0; padding:20px; }
    h1 { text-align:center; margin-bottom:20px; }
    .toolbar { display:flex; justify-content:flex-end; gap:10px; margin-bottom:20px; }
    .btn { padding:8px 12px; border:none; border-radius:6px; cursor:pointer; font-weight:bold; }
    .btn.primary { background:#0ea5e9; color:#fff; }
    .btn.print { background:#f59e0b; color:#fff; }
    .btn.toggle { background:#64748b; color:#fff; }
    #detailsBox { background:#fff; border:1px solid #ddd; border-radius:10px; padding:15px; margin-bottom:20px; display:none; }
    #detailsBox input { display:inline-block; margin:6px; padding:8px; border:1px solid #ccc; border-radius:6px; }
  </style>
</head>
<body>

  <h1>צו שיקום כלכלי וחדלות פירעון – טבלת חישוב</h1>

  <!-- סרגל עליון -->
  <div class="toolbar">
    <button class="btn print" id="printBtn">🖨️ הדפסה</button>
    <button class="btn primary" id="sendBtn">📤 שלח נתונים</button>
    <button class="btn toggle" id="toggleDetails">📝 פרטי טופס</button>
  </div>

  <!-- תיבת פרטים -->
  <div id="detailsBox">
    <input type="text" id="fillerName" placeholder="שם ממלא טופס">
    <input type="text" id="caseNumber" placeholder="מס' תיק">
    <input type="text" id="autoDate" readonly>
  </div>

  <script>
    // פותח/סוגר את פרטי הטופס
    document.getElementById("toggleDetails").addEventListener("click", () => {
      const box = document.getElementById("detailsBox");
      box.style.display = (box.style.display === "none" || box.style.display==="") ? "block" : "none";
    });

    // שדה תאריך אוטומטי
    document.getElementById("autoDate").value = new Date().toLocaleDateString("he-IL");

    // שליחת נתונים ל-Google Sheets
    document.getElementById("sendBtn").addEventListener("click", () => {
      const payload = {
        fillerName: document.getElementById("fillerName").value || "",
        caseNumber: document.getElementById("caseNumber").value || "",
        date: document.getElementById("autoDate").value
      };

      fetch("https://docs.google.com/spreadsheets/d/1XjpT0T2d27ISI80fyXTYZtRXQjn5Lu-P_P3NwnlzfQQ/edit?usp=sharing", {
        method: "POST",
        mode: "no-cors",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(payload)
      })
      .then(() => alert("✅ הנתונים נשלחו בהצלחה!"))
      .catch(err => alert("❌ שגיאה בשליחה: " + err.message));
    });

    // הדפסה
    document.getElementById("printBtn").addEventListener("click", () => {
      window.print();
    });
  </script>
</body>
</html>
