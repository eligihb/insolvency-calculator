<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>צו שיקום כלכלי וחדלות פירעון – טבלת חישוב</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body {font-family:'Heebo',sans-serif;background:#f7f9fc;margin:0;color:#0B2533}
    header{background:#0B1D2A;color:#fff;padding:20px;text-align:center}
    header h1{margin:0;font-size:24px}
    header p{margin:4px 0 0;font-size:14px;opacity:.85}
    .wrap{display:grid;grid-template-columns:360px 1fr;gap:16px;max-width:1400px;margin:auto;padding:16px}
    .card{background:#fff;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,0.08);padding:14px}
    h2{margin:0 0 12px;font-size:18px}
    label{font-weight:700;font-size:14px;display:block;margin:6px 0}
    input,select,button{font-family:inherit;font-size:14px}
    input[type="text"],input[type="date"],input[type="number"],select{width:100%;max-width:220px;padding:8px;border:1px solid #d7dee6;border-radius:10px;background:#F3F7FE}
    input[type="number"]{text-align:left}
    .seg{display:flex;gap:6px;flex-wrap:wrap;margin:6px 0}
    .pill{padding:6px 10px;border-radius:999px;background:#eef2f7;cursor:pointer;font-weight:800;border:1px solid #e4e9ef}
    .pill.active{background:#0ea5e9;color:#fff;border-color:#0ea5e9}
    .quick{display:flex;gap:6px;align-items:center;flex-wrap:wrap}
    .chip{padding:6px 10px;border-radius:999px;background:#eef2f7;border:1px solid #e4e9ef;cursor:pointer;font-weight:800}
    .chip.active{background:#cfefff;border-color:#90d9ff}
    .btn{padding:8px 12px;border-radius:10px;border:1px solid #e1e6ef;background:#eef2f7;cursor:pointer;font-weight:800}
    .btn.primary{background:#0ea5e9;color:#fff;border:none}
    table{width:100%;border-collapse:collapse;margin-top:10px;font-size:13px}
    th,td{border:1px solid #e7edf5;padding:6px;text-align:center}
    th{background:#f0f4fa}
    footer{padding:10px;text-align:center;color:#5b6b76;font-size:12px}
  </style>
</head>
<body>
  <header>
    <h1>צו שיקום כלכלי וחדלות פירעון – טבלת חישוב</h1>
    <p>הזנת נתוני הצו, פריסה אוטומטית, תיעוד תשלומים בפועל ופיגורים</p>
  </header>

  <div class="wrap">
    <section class="card">
      <h2>פרטי צו</h2>
      <label>שם ממלא הטופס</label>
      <input type="text" id="fillerName" placeholder="השם שלך">
      <label>מס' תיק</label>
      <input type="text" id="caseNumber" placeholder="12345">
      <label>שם החייב/ת</label>
      <input type="text" id="debtorName" placeholder="שם מלא">
      <label>תאריך מילוי</label>
      <input type="text" id="fillDate" readonly>
      <label>תאריך מתן הצו</label>
      <input type="date" id="orderDate">
      <label>תחולת חיוב</label>
      <div class="seg" id="startSeg">
        <div class="pill active" data-v="next">חודש הבא</div>
        <div class="pill" data-v="immediate">מיידי</div>
      </div>
      <label>מס' חודשי התוכנית</label>
      <div class="quick" id="termQuick">
        <div class="chip active" data-v="36">36</div>
        <div class="chip" data-v="48">48</div>
        <div class="chip" data-v="60">60</div>
        <input type="number" id="termMonths" min="1" max="120" placeholder="אחר...">
      </div>
      <label>צו תשלומים</label>
      <div class="seg" id="modeSeg">
        <div class="pill active" data-v="flat">קבוע</div>
        <div class="pill" data-v="tiered">תשלום מדורג</div>
        <div class="pill" data-v="reduction">הפחתת תשלומים</div>
      </div>
      <div id="flatFields">
        <label>סכום חודשי קבוע</label>
        <input type="number" id="flatAmount" min="0" placeholder="לדוגמה: 1800">
      </div>
    </section>

    <section>
      <div class="card">
        <h2>פריסה חודשית</h2>
        <div id="scheduleWrap"></div>
      </div>
      <div class="card">
        <h2>מדדי התקדמות</h2>
        <div style="display:flex;gap:10px;flex-wrap:wrap">
          <div style="flex:1"><div style="color:#6b7c88;font-size:12px">סך התוכנית</div><div id="totalKPI" style="font-weight:900">—</div></div>
          <div style="flex:1"><div style="color:#6b7c88;font-size:12px">פיגור / מס' פיגורים</div><div id="arrearsKPI" style="font-weight:900">—</div></div>
        </div>
        <button class="btn primary" id="sendBtn">שלח נתונים</button>
      </div>
    </section>
  </div>

  <footer>נבנה ע"י EY · גרסה 8566.2.5</footer>

  <script>
    // DOM refs
    const orderDate=document.getElementById('orderDate');
    const startSeg=document.getElementById('startSeg');
    const termMonths=document.getElementById('termMonths');
    const termQuick=document.getElementById('termQuick');
    const modeSeg=document.getElementById('modeSeg');
    const flatAmount=document.getElementById('flatAmount');
    const scheduleWrap=document.getElementById('scheduleWrap');
    const totalKPI=document.getElementById('totalKPI');
    const arrearsKPI=document.getElementById('arrearsKPI');

    // helpers
    const getStart=()=> startSeg.querySelector('.pill.active').dataset.v;
    const getMode =()=> modeSeg.querySelector('.pill.active').dataset.v;

    // interactions
    startSeg.addEventListener('click',e=>{
      const p=e.target.closest('.pill'); if(!p) return;
      startSeg.querySelectorAll('.pill').forEach(x=>x.classList.remove('active'));
      p.classList.add('active');
      build();
    });

    modeSeg.addEventListener('click',e=>{
      const p=e.target.closest('.pill'); if(!p) return;
      modeSeg.querySelectorAll('.pill').forEach(x=>x.classList.remove('active'));
      p.classList.add('active');
      build();
    });

    termQuick.addEventListener('click',e=>{
      const c=e.target.closest('.chip'); if(!c) return;
      termQuick.querySelectorAll('.chip').forEach(x=>x.classList.remove('active'));
      c.classList.add('active');
      termMonths.value=''; // ביטול קלט חופשי
      build();
    });

    document.querySelectorAll('input').forEach(i=> i.addEventListener('input', build));

    function build(){
      // נדרש תאריך צו
      if(!orderDate.value){ scheduleWrap.innerHTML='<div style="color:#6b7c88">בחר תאריך מתן צו להתחלה</div>'; return; }
      // קביעת תאריך התחלה
      const start=new Date(orderDate.value);
      if(getStart()==='next') start.setMonth(start.getMonth()+1);
      // חודשי תוכנית
      const quickChip=termQuick.querySelector('.chip.active');
      const months = termMonths.value ? parseInt(termMonths.value) : (quickChip? parseInt(quickChip.dataset.v):36);
      if(!(months>0)){ scheduleWrap.innerHTML=''; return; }
      // סכום בסיסי
      const base = parseInt(flatAmount.value)||0;

      // בניית טבלה
      let total=0; const rows=[];
      for(let i=0;i<months;i++){
        const d=new Date(start); d.setMonth(d.getMonth()+i);
        total += base;
        rows.push(`<tr><td>${d.toLocaleDateString('he-IL',{month:'long'})}</td><td>${d.getFullYear()}</td><td>₪ ${base.toLocaleString('he-IL')}</td></tr>`);
      }
      const html = `
        <table>
          <thead><tr><th>חודש</th><th>שנה</th><th>סכום צפוי</th></tr></thead>
          <tbody>${rows.join('')}</tbody>
        </table>`;
      scheduleWrap.innerHTML=html;
      totalKPI.textContent = '₪ ' + total.toLocaleString('he-IL');
      arrearsKPI.textContent = '—';
    }

    // init
    document.getElementById('fillDate').value = new Date().toLocaleDateString('he-IL');
    build();

    // send stub
    document.getElementById('sendBtn').addEventListener('click',()=> alert('כאן נוסיף חיבור ל-Google Sheets'));
  </script>
</body>
</html>
