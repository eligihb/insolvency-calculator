<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>×¦×• ×©×™×§×•× â€“ ×¤×¨×˜×™ ×˜×•×¤×¡ ×•×©×œ×™×—×”</title>
  <style>
    body { font-family: Arial, sans-serif; background:#f7f9fc; margin:0; padding:20px; }
    h1 { text-align:center; margin-bottom:20px; }
    .toolbar { display:flex; justify-content:flex-end; gap:10px; margin-bottom:20px; }
    .btn { padding:8px 12px; border:none; border-radius:6px; cursor:pointer; font-weight:bold; }
    .btn.primary { background:#0ea5e9; color:#fff; }
    .btn.print { background:#f59e0b; color:#fff; }
    .btn.toggle { background:#64748b; color:#fff; }
    #detailsBox { background:#fff; border:1px solid #ddd; border-radius:10px; padding:15px; margin-bottom:20px; display:none; }
    #detailsBox input { display:inline-block; margin:6px; padding:8px; border:1px solid #ccc; border-radius:6px; }
  </style>
</head>
<body>

  <h1>×¦×• ×©×™×§×•× ×›×œ×›×œ×™ ×•×—×“×œ×•×ª ×¤×™×¨×¢×•×Ÿ â€“ ×˜×‘×œ×ª ×—×™×©×•×‘</h1>

  <!-- ×¡×¨×’×œ ×¢×œ×™×•×Ÿ -->
  <div class="toolbar">
    <button class="btn print" id="printBtn">ğŸ–¨ï¸ ×”×“×¤×¡×”</button>
    <button class="btn primary" id="sendBtn">ğŸ“¤ ×©×œ×— × ×ª×•× ×™×</button>
    <button class="btn toggle" id="toggleDetails">ğŸ“ ×¤×¨×˜×™ ×˜×•×¤×¡</button>
  </div>

  <!-- ×ª×™×‘×ª ×¤×¨×˜×™× -->
  <div id="detailsBox">
    <input type="text" id="fillerName" placeholder="×©× ×××œ× ×˜×•×¤×¡">
    <input type="text" id="caseNumber" placeholder="××¡' ×ª×™×§">
    <input type="text" id="autoDate" readonly>
  </div>

  <script>
    // ×¤×•×ª×—/×¡×•×’×¨ ××ª ×¤×¨×˜×™ ×”×˜×•×¤×¡
    document.getElementById("toggleDetails").addEventListener("click", () => {
      const box = document.getElementById("detailsBox");
      box.style.display = (box.style.display === "none" || box.style.display==="") ? "block" : "none";
    });

    // ×©×“×” ×ª××¨×™×š ××•×˜×•××˜×™
    document.getElementById("autoDate").value = new Date().toLocaleDateString("he-IL");

    // ×©×œ×™×—×ª × ×ª×•× ×™× ×œ-Google Sheets
    document.getElementById("sendBtn").addEventListener("click", () => {
      const payload = {
        fillerName: document.getElementById("fillerName").value || "",
        caseNumber: document.getElementById("caseNumber").value || "",
        date: document.getElementById("autoDate").value
      };

      fetch("https://docs.google.com/spreadsheets/d/1XjpT0T2d27ISI80fyXTYZtRXQjn5Lu-P_P3NwnlzfQQ/edit?usp=sharing", {
        method: "POST",
        mode: "no-cors",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(payload)
      })
      .then(() => alert("âœ… ×”× ×ª×•× ×™× × ×©×œ×—×• ×‘×”×¦×œ×—×”!"))
      .catch(err => alert("âŒ ×©×’×™××” ×‘×©×œ×™×—×”: " + err.message));
    });

    // ×”×“×¤×¡×”
    document.getElementById("printBtn").addEventListener("click", () => {
      window.print();
    });
  </script>
</body>
</html>
