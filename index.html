<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>××—×©×‘×•×Ÿ ×¦×• ×ª×©×œ×•××™×</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;500;700&display=swap" rel="stylesheet">
<style>
  :root{
    --primary:#005f73; --secondary:#0a9396; --bg:#f4f4f4; --panel:#fff;
    --text:#222; --muted:#6b7280; --border:#d9e1e6; --accent:#ee9b00; --danger:#b91c1c;
    --card:#eef6f6; --card2:#e9f5f5; --blue:#0b62ff;
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);font-family:'Heebo',sans-serif;color:var(--text);display:flex;justify-content:center}
  .calc{width:100%;max-width:1100px;background:var(--panel);border-radius:14px;overflow:hidden;box-shadow:0 10px 30px rgba(0,0,0,.08)}
  header{background:var(--primary);color:#fff;padding:14px 18px;display:flex;align-items:center;gap:14px;justify-content:center;position:relative}
  header h1{margin:0;font-size:1.8rem}
  .chip-year{position:absolute;right:18px;top:12px;background:#0b7;opacity:.9;color:#fff;border-radius:999px;padding:6px 10px;font-size:.85rem}
  .grid{display:grid;grid-template-columns:1fr 1fr}
  .left{background:var(--card2);padding:20px}
  .right{border-inline-start:1px solid var(--border);padding:20px}
  h2.sec{margin:6px 0 14px;color:var(--primary);font-size:1.25rem}
  /* ×›×¤×ª×•×¨×™ ×¤×¢×•×œ×” ×¢×œ×™×•× ×™× */
  .top-actions{display:flex;gap:10px;margin-bottom:14px}
  .btn{border:1px solid var(--border);background:#fff;border-radius:10px;padding:8px 12px;cursor:pointer;display:inline-flex;align-items:center;gap:8px}
  .btn:hover{background:#f8fafc}
  .btn-danger{border-color:#f4cccc;background:#fff}
  /* ×©×•×¨×ª ×¡×˜×˜×•×¡ + ××™ ×‘×”×œ×™×š */
  .row-inline{display:grid;grid-template-columns:1fr auto;gap:10px;align-items:center}
  select,input{width:100%;padding:10px 12px;border:1px solid var(--border);border-radius:10px;background:#fff;font-size:1rem}
  select:focus,input:focus{outline:none;border-color:var(--secondary);box-shadow:0 0 0 3px rgba(10,147,150,.20)}
  .chips{display:flex;gap:8px;flex-wrap:wrap}
  .chip{border:1px solid var(--border);background:#fff;border-radius:999px;padding:8px 14px;cursor:pointer}
  .chip.active{background:var(--secondary);color:#fff;border-color:var(--secondary)}
  .chip-joint{border:1px solid var(--border);background:#fff;border-radius:999px;padding:8px 14px;cursor:pointer}
  .chip-joint.active{background:#ffeded;color:#a10000;border-color:#ffb3b3}
  /* ×–×•×’×•×ª ×©×“×•×ª â€“ ×”×—×™×™×‘ ×ª××™×“ ×‘×™××™×Ÿ */
  .pair{display:grid;grid-template-columns:1fr 1fr;gap:12px}
  .pair .debtor{grid-column:2}
  .pair .partner{grid-column:1}
  /* ×‘×œ×•×§×™ ×ª×•×¦××” */
  .cards{display:grid;grid-template-columns:repeat(2,1fr);gap:14px}
  .card{background:#fff;border:1px solid var(--border);border-radius:12px;padding:14px;text-align:center}
  .card .title{color:var(--muted);margin-bottom:8px}
  .card .val{font-weight:700;color:var(--accent)}
  .strip{border-top:2px solid #cfe9e9;margin:10px 0}
  .big{font-size:1.4rem}
  .blue{color:var(--blue)}
  /* ×”×’×‘×œ×•×ª ×”×“×¤×¡×” */
  @media print{
    .top-actions{display:none}
    .chip-year{display:none}
    body{background:#fff}
  }
  /* ××•×‘×™×™×œ: ×”×™×©××¨ ×¨×¡×¤×•× ×¡×™×‘×™, ××‘×œ ×œ× × ×•×’×¢×™× ×¢×›×©×™×• ×‘×¢×•××§ */
  @media(max-width:900px){
    .grid{grid-template-columns:1fr}
    .right{border-inline-start:none;border-top:1px solid var(--border)}
  }
</style>
</head>
<body>
<div class="calc" id="calcRoot">
  <header>
    <div class="chip-year" id="verChip">2025×³ ××¢×•×“×›×Ÿ</div>
    <h1>××—×©×‘×•×Ÿ ×¦×• ×ª×©×œ×•××™×</h1>
  </header>

  <div class="grid">
    <!-- ×ª×•×¦××•×ª â€“ ××©×××œ -->
    <section class="left">
      <div class="top-actions">
        <button class="btn" id="btnReset">â™»ï¸ ××™×¤×•×¡</button>
        <button class="btn" id="btnEmail">âœ‰ï¸ ×©×œ×— ×‘××™×™×œ</button>
        <button class="btn" id="btnSnap">ğŸ“¸ ×¦×™×œ×•× ××¡×š</button>
      </div>

      <h2 class="sec">×ª×•×¦××•×ª ×”×—×™×©×•×‘</h2>

      <div class="cards">
        <div class="card">
          <div class="title">×¡×š ×”×›× ×¡×•×ª</div>
          <div class="val big" id="totalIncome">â‚ª 0</div>
        </div>
        <div class="card">
          <div class="title">×§×¦×‘×ª ×‘×™×˜×•×— ×œ××•××™</div>
          <div class="val big" id="nlAllowance">â‚ª 0</div>
        </div>

        <div class="card">
          <div class="title">×¡×š ×”×•×¦××•×ª</div>
          <div class="val big" id="totalExp">â‚ª 0</div>
        </div>
        <div class="card">
          <div class="title">×“××™ ××—×™×™×” ×‘×›×‘×•×“</div>
          <div class="val big" id="livingCost">â‚ª 0</div>
        </div>

        <div class="card" style="grid-column:1 / -1">
          <div class="title">×”×›× ×¡×” ×¤× ×•×™×” ×œ×ª× ×”××©×¤×—×ª×™</div>
          <div class="val big blue" id="freeIncome">â‚ª 0</div>
        </div>

        <div class="card">
          <div class="title" id="debtorRatioLabel">××—×•×– ×”×›× ×¡×” (×—×™×™×‘)</div>
          <div class="val" id="debtorRatio">0%</div>
        </div>
        <div class="card">
          <div class="title" id="partnerRatioLabel">××—×•×– ×”×›× ×¡×” (×‘×ª ×–×•×’)</div>
          <div class="val" id="partnerRatio">0%</div>
        </div>

        <div class="card">
          <div class="title" id="debtorPayLabel">×ª×©×œ×•× ××•×¦×¢ (×—×™×™×‘)</div>
          <div class="val" id="debtorPay">â‚ª 0</div>
        </div>
        <div class="card">
          <div class="title" id="partnerPayLabel">×ª×©×œ×•× ××•×¦×¢ (×‘×ª ×–×•×’)</div>
          <div class="val" id="partnerPay">â‚ª 0</div>
        </div>

        <div class="card" style="grid-column:1 / -1">
          <div class="title">×ª×©×œ×•× ×—×•×“×©×™ ×œ×ª× ××©×¤×—×ª×™</div>
          <div class="val big" id="finalPay">â‚ª 0</div>
        </div>
      </div>
    </section>

    <!-- ×§×œ×˜×™× â€“ ××™××™×Ÿ -->
    <section class="right">
      <div class="row-inline" style="margin-bottom:10px">
        <select id="status">
          <option value="" disabled selected>×¡×˜×˜×•×¡ ××©×¤×—×ª×™ â€” ×‘×—×¨ ×¡×˜×˜×•×¡...</option>
          <option value="×™×—×™×“/× ×©×•×™ ×—×™ ×‘× ×¤×¨×“">×™×—×™×“/× ×©×•×™ ×—×™ ×‘× ×¤×¨×“</option>
          <option value="×¨×•×•×§/×’×¨×•×©/××œ××Ÿ + ×™×œ×“">×¨×•×•×§/×’×¨×•×©/××œ××Ÿ + ×™×œ×“</option>
          <option value="×–×•×’">×–×•×’</option>
          <option value="×–×•×’+×™×œ×“">×–×•×’+×™×œ×“</option>
          <option value="×–×•×’+ 2 ×™×œ×“×™×">×–×•×’+ 2 ×™×œ×“×™×</option>
          <option value="×–×•×’+ 3 ×™×œ×“×™×">×–×•×’+ 3 ×™×œ×“×™×</option>
          <option value="×–×•×’+ 4 ×™×œ×“×™×">×–×•×’+ 4 ×™×œ×“×™×</option>
          <option value="×–×•×’+ 5 ×™×œ×“×™×">×–×•×’+ 5 ×™×œ×“×™×</option>
          <option value="×–×•×’+ 6 ×™×œ×“×™×">×–×•×’+ 6 ×™×œ×“×™×</option>
          <option value="×–×•×’+ 7 ×™×œ×“×™×">×–×•×’+ 7 ×™×œ×“×™×</option>
          <option value="×–×•×’+ 8 ×™×œ×“×™×">×–×•×’+ 8 ×™×œ×“×™×</option>
          <option value="×–×•×’+ 9 ×™×œ×“×™×">×–×•×’+ 9 ×™×œ×“×™×</option>
          <option value="×–×•×’+ 10 ×™×œ×“×™×">×–×•×’+ 10 ×™×œ×“×™×</option>
        </select>

        <div class="chips" id="whoRow">
          <button type="button" class="chip" data-g="m">×—×™×™×‘</button>
          <button type="button" class="chip" data-g="f">×—×™×™×‘×ª</button>
          <button type="button" class="chip-joint" id="btnJoint">×©× ×™ ×‘× ×™ ×”×–×•×’ ×‘×”×œ×™×š?</button>
        </div>
      </div>

      <h2 class="sec">(â‚ª) ×”×›× ×¡×•×ª ×•×”×•×¦××•×ª ×”×ª× ×”××©×¤×—×ª×™</h2>

      <div class="pair" style="margin-bottom:8px">
        <div class="partner">
          <label>×”×›× ×¡×” (×‘×ª/×‘×Ÿ ×–×•×’)</label>
          <input type="number" id="incPartner" placeholder="×”×–×Ÿ ×”×›× ×¡×”">
        </div>
        <div class="debtor">
          <label id="incDebtorLabel">×”×›× ×¡×” (×—×™×™×‘)</label>
          <input type="number" id="incDebtor" placeholder="×”×–×Ÿ ×”×›× ×¡×”">
        </div>
      </div>

      <div class="pair" style="margin-bottom:8px">
        <div class="partner">
          <label>×”×›× ×¡×•×ª ××—×¨×•×ª (×‘×ª/×‘×Ÿ ×–×•×’)</label>
          <input type="number" id="othPartner" placeholder="×”×–×Ÿ ×”×›× ×¡×•×ª ××—×¨×•×ª">
        </div>
        <div class="debtor">
          <label id="othDebtorLabel">×”×›× ×¡×•×ª ××—×¨×•×ª (×—×™×™×‘)</label>
          <input type="number" id="othDebtor" placeholder="×”×–×Ÿ ×”×›× ×¡×•×ª ××—×¨×•×ª">
        </div>
      </div>

      <div class="pair" style="margin-bottom:8px">
        <div class="partner">
          <label>×§×¦×‘×” (×‘×Ÿ/×‘×ª ×–×•×’)</label>
          <input type="number" id="allowPartner" placeholder="×”×–×Ÿ ×§×¦×‘×”">
        </div>
        <div class="debtor">
          <label>×§×¦×‘×” (×—×™×™×‘/×ª)</label>
          <input type="number" id="allowDebtor" placeholder="×”×–×Ÿ ×§×¦×‘×”">
        </div>
      </div>

      <div class="pair" style="margin-bottom:8px">
        <div class="partner">
          <label>×”×•×¦××•×ª ×—×¨×™×’×•×ª (×¨×¤×•××™×•×ª ×•×›×•')</label>
          <input type="number" id="expUnusual" placeholder="×”×–×Ÿ ×”×•×¦××•×ª">
        </div>
        <div class="debtor">
          <label>×”×•×¦××•×ª ×˜×™×¤×•×œ ×•×¦×”×¨×•× ×™×</label>
          <input type="number" id="expChildcare" placeholder="×”×–×Ÿ ×”×•×¦××•×ª">
        </div>
      </div>

      <div class="pair">
        <div class="partner" style="grid-column:1 / -1">
          <label>×”×•×¦××•×ª ××–×•× ×•×ª</label>
          <input type="number" id="expAlimony" placeholder="×”×–×Ÿ ×”×•×¦××•×ª ××–×•× ×•×ª">
        </div>
      </div>

      <div style="margin-top:12px">
        <a href="#" id="reportMetaLink" style="color:var(--secondary);text-decoration:none">×¤×¨×˜×™ ×“×•×´×— â–¾</a>
        <div id="reportMeta" style="display:none;margin-top:8px;gap:8px" class="pair">
          <div class="partner">
            <input type="text" id="caseId" placeholder="××¡' ×ª×™×§">
          </div>
          <div class="debtor">
            <input type="text" id="authorName" placeholder="×©× ×¢×•×¨×š/×ª ×”×—×™×©×•×‘">
          </div>
          <div class="partner" style="grid-column:1 / -1">
            <input type="text" id="note" placeholder="×”×¢×¨×” (×¨×©×•×ª)">
          </div>
        </div>
      </div>
    </section>
  </div>
</div>

<!-- html2canvas ×œ×¦×™×œ×•× ××¡×š -->
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
<script>
(function(){
  // ×©× ×” ×œ×©×‘×‘
  document.getElementById('verChip').textContent = new Date().getFullYear() + '×³ ××¢×•×“×›×Ÿ';

  // × ×ª×•× ×™ ×‘×¡×™×¡
  const livingTable = {
    "×™×—×™×“/× ×©×•×™ ×—×™ ×‘× ×¤×¨×“":4556,
    "×¨×•×•×§/×’×¨×•×©/××œ××Ÿ + ×™×œ×“":6056,
    "×–×•×’":6024,"×–×•×’+×™×œ×“":7524,"×–×•×’+ 2 ×™×œ×“×™×":9024,"×–×•×’+ 3 ×™×œ×“×™×":10524,"×–×•×’+ 4 ×™×œ×“×™×":12024,
    "×–×•×’+ 5 ×™×œ×“×™×":13324,"×–×•×’+ 6 ×™×œ×“×™×":14624,"×–×•×’+ 7 ×™×œ×“×™×":15924,"×–×•×’+ 8 ×™×œ×“×™×":17224,"×–×•×’+ 9 ×™×œ×“×™×":18524,"×–×•×’+ 10 ×™×œ×“×™×":19824
  };
  const childAllowance = {0:0,1:169,2:383,3:597,4:811,5:980,6:1149,7:1318,8:1487,9:1656,10:1825};
  const kidsCountFromStatus = (s)=>{
    if(!s) return 0;
    if(s.includes('×™×—×™×“')) return 0;
    if(s.includes('+ 10')) return 10;
    const m = s.match(/(\d+)\s?×™×œ×“/); return m? +m[1] : (s.includes('×–×•×’')?0:0);
  };

  // ××œ×× ×˜×™×
  const statusEl = document.getElementById('status');
  const btnsWho = document.querySelectorAll('.chip[data-g]');
  const btnJoint = document.getElementById('btnJoint');

  const incDebtor = document.getElementById('incDebtor');
  const incPartner = document.getElementById('incPartner');
  const othDebtor = document.getElementById('othDebtor');
  const othPartner = document.getElementById('othPartner');
  const allowDebtor = document.getElementById('allowDebtor');
  const allowPartner = document.getElementById('allowPartner');
  const expUnusual = document.getElementById('expUnusual');
  const expChildcare = document.getElementById('expChildcare');
  const expAlimony = document.getElementById('expAlimony');

  const totalIncome = document.getElementById('totalIncome');
  const nlAllowance = document.getElementById('nlAllowance');
  const totalExp = document.getElementById('totalExp');
  const livingCost = document.getElementById('livingCost');
  const freeIncome = document.getElementById('freeIncome');
  const debtorRatio = document.getElementById('debtorRatio');
  const partnerRatio = document.getElementById('partnerRatio');
  const debtorPay = document.getElementById('debtorPay');
  const partnerPay = document.getElementById('partnerPay');
  const finalPay = document.getElementById('finalPay');

  const incDebtorLabel = document.getElementById('incDebtorLabel');
  const othDebtorLabel = document.getElementById('othDebtorLabel');
  const debtorRatioLabel = document.getElementById('debtorRatioLabel');
  const partnerRatioLabel = document.getElementById('partnerRatioLabel');
  const debtorPayLabel   = document.getElementById('debtorPayLabel');
  const partnerPayLabel  = document.getElementById('partnerPayLabel');

  let who = 'm'; // m/f
  let joint = false;

  // ×¢×–×¨×”: ×¤×•×¨××˜ ×›×¡×¤×™
  const fmt = n => new Intl.NumberFormat('he-IL',{style:'currency',currency:'ILS',minimumFractionDigits:0}).format(Math.max(0, Math.floor(n)));

  function refreshLabels(){
    const single = statusEl.value.includes('×™×—×™×“') || statusEl.value.includes('×¨×•×•×§');
    const debtorTxt = (who==='m' ? '×—×™×™×‘' : '×—×™×™×‘×ª');
    incDebtorLabel.textContent = single ? '×”×›× ×¡×” (×—×™×™×‘/×ª)' : `×”×›× ×¡×” (${debtorTxt})`;
    othDebtorLabel.textContent = single ? '×”×›× ×¡×•×ª ××—×¨×•×ª (×—×™×™×‘/×ª)' : `×”×›× ×¡×•×ª ××—×¨×•×ª (${debtorTxt})`;

    debtorRatioLabel.textContent = `××—×•×– ×”×›× ×¡×” (${debtorTxt})`;
    partnerRatioLabel.textContent = `××—×•×– ×”×›× ×¡×” (${who==='m'?'×‘×ª ×–×•×’':'×‘×Ÿ ×–×•×’'})`;
    debtorPayLabel.textContent   = `×ª×©×œ×•× ××•×¦×¢ (${debtorTxt})`;
    partnerPayLabel.textContent  = `×ª×©×œ×•× ××•×¦×¢ (${who==='m'?'×‘×ª ×–×•×’':'×‘×Ÿ ×–×•×’'})`;
  }

  function calc(){
    const stat = statusEl.value || '';
    const kids = kidsCountFromStatus(stat);
    const base = livingTable[stat] || 0;
    const child = childAllowance[kids] || 0;

    livingCost.textContent = fmt(base);
    nlAllowance.textContent = fmt(child);

    const dInc = +incDebtor.value||0, pInc = +incPartner.value||0;
    const dOth = +othDebtor.value||0,  pOth = +othPartner.value||0;
    const dAlw = +allowDebtor.value||0, pAlw = +allowPartner.value||0;
    const eUn  = +expUnusual.value||0, eCh  = +expChildcare.value||0, eAl = +expAlimony.value||0;

    const incomes = dInc+pInc+dOth+pOth+dAlw+pAlw+child;
    totalIncome.textContent = fmt(incomes);

    const expenses = base + eUn + eCh + eAl;
    totalExp.textContent = fmt(expenses);

    const free = incomes - expenses;
    freeIncome.textContent = free>0 ? fmt(free) : '××™×Ÿ ×”×›× ×¡×” ×¤× ×•×™×”';

    const totForRatio = (dInc+dOth) + (pInc+pOth);
    const rD = totForRatio>0 ? (dInc+dOth)/totForRatio : 0;
    const rP = totForRatio>0 ? (pInc+pOth)/totForRatio : 0;
    debtorRatio.textContent  = (rD*100).toFixed(1)+'%';
    partnerRatio.textContent = (rP*100).toFixed(1)+'%';

    const dPay = rD>0 ? Math.floor(((free*rD)/2)/10)*10 : 0;
    const pPay = rP>0 ? Math.floor(((free*rP)/2)/10)*10 : 0;
    debtorPay.textContent  = fmt(dPay);
    partnerPay.textContent = fmt(pPay);

    // × ×•×¡×—×ª ×©× ×™ ×‘× ×™ ×–×•×’ ×‘×”×œ×™×š (×›×©×›×¤×ª×•×¨ ×“×•×œ×§): (DI/2 - partnerPay) * rD + partnerPay
    let final = dPay;
    if(joint){
      const half = free/2;
      const part = Math.max(0, half - pPay);
      final = Math.floor(((part * rD) + pPay)/10)*10;
    }
    // "×ª×™×§ ××¤×¡" â€“ ×¨×§ ×× ×™×© ×”×›× ×¡×” ××§×¦×‘××•×ª ×‘×œ×‘×“ ×•×œ×—×™×™×‘ ××™×Ÿ ×”×›× ×¡×•×ª ×›×œ×œ
    const onlyAllowances = (dInc+dOth+pInc+pOth)===0 && (dAlw+pAlw+child)>0;
    if(onlyAllowances && dInc===0 && dOth===0){
      finalPay.innerHTML = '<span style="color:#a10000;font-weight:700">×ª×™×§ ××¤×¡</span>';
    }else{
      finalPay.textContent = fmt(final);
    }
  }

  // ××™×¨×•×¢×™×
  statusEl.addEventListener('change', ()=>{ refreshLabels(); calc(); });

  btnsWho.forEach(b=>{
    b.addEventListener('click', ()=>{
      btnsWho.forEach(x=>x.classList.remove('active'));
      b.classList.add('active');
      who = b.dataset.g;
      refreshLabels(); calc();
    });
  });
  // ×‘×¨×™×¨×ª ××—×“×œ: ×—×™×™×‘ ××¡×•××Ÿ
  document.querySelector('.chip[data-g="m"]').classList.add('active');

  btnJoint.addEventListener('click', ()=>{
    joint = !joint;
    btnJoint.classList.toggle('active', joint);
    calc();
  });

  [incDebtor,incPartner,othDebtor,othPartner,allowDebtor,allowPartner,expUnusual,expChildcare,expAlimony]
    .forEach(el=>el.addEventListener('input', calc));

  // ×¤×¨×˜×™ ×“×•"×— â€“ ×¤×ª×™×—×”/×¡×’×™×¨×”
  const link = document.getElementById('reportMetaLink');
  const meta = document.getElementById('reportMeta');
  link.addEventListener('click', (e)=>{e.preventDefault(); meta.style.display = (meta.style.display==='none'||!meta.style.display)?'grid':'none';});

  // ××™×¤×•×¡
  document.getElementById('btnReset').addEventListener('click', ()=>{
    document.getElementById('calcRoot').querySelectorAll('input').forEach(i=>i.value='');
    statusEl.selectedIndex = 0;
    joint=false; btnJoint.classList.remove('active');
    btnsWho.forEach(x=>x.classList.remove('active'));
    document.querySelector('.chip[data-g="m"]').classList.add('active'); who='m';
    refreshLabels(); calc();
  });

  // ×¦×™×œ×•× ××¡×š â€“ PNG ×‘×œ×©×•× ×™×ª ×—×“×©×”
  document.getElementById('btnSnap').addEventListener('click', async ()=>{
    try{
      const node = document.querySelector('.calc');
      const canvas = await html2canvas(node,{scale:2,background:'#ffffff',useCORS:true});
      const url = canvas.toDataURL('image/png');
      const w = window.open('about:blank','_blank');
      w.document.write('<title>×¦×™×œ×•× ××¡×š ×”××—×©×‘×•×Ÿ</title>');
      w.document.write('<img style="width:100%;height:auto;display:block" src="'+url+'"/>');
      w.document.close();
    }catch(e){
      alert('×©×’×™××” ×‘×¦×™×œ×•× ×”××¡×š');
    }
  });

  // ××™×™×œ â€“ ××™×™×¦×¨ ×ª×§×¦×™×¨ ×•×¤×•×ª×— mailto
  document.getElementById('btnEmail').addEventListener('click', ()=>{
    const gt = id => (document.getElementById(id)?.textContent||'').trim();
    const subject = '××—×©×‘×•×Ÿ ×¦×• ×ª×©×œ×•××™× â€“ ' + (document.getElementById('caseId').value||'×œ×œ× ××¡\' ×ª×™×§');
    const body = [
      '×ª×§×¦×™×¨ ×ª×•×¦××•×ª:',
      '×¡×š ×”×›× ×¡×•×ª: ' + gt('totalIncome'),
      '×¡×š ×”×•×¦××•×ª: ' + gt('totalExp'),
      '×”×›× ×¡×” ×¤× ×•×™×”: ' + gt('freeIncome'),
      gt('debtorRatioLabel') + ': ' + gt('debtorRatio'),
      gt('partnerRatioLabel') + ': ' + gt('partnerRatio'),
      gt('debtorPayLabel')   + ': ' + gt('debtorPay'),
      gt('partnerPayLabel')  + ': ' + gt('partnerPay'),
      '×ª×©×œ×•× ×—×•×“×©×™ ×œ×ª× ××©×¤×—×ª×™: ' + gt('finalPay'),
      '',
      '×¤×¨×˜×™ ×“×•×´×—:',
      '××¡\' ×ª×™×§: ' + (document.getElementById('caseId').value||'-'),
      '×©× ×¢×•×¨×š/×ª: ' + (document.getElementById('authorName').value||'-'),
      '×”×¢×¨×”: ' + (document.getElementById('note').value||'-'),
      '',
      '×”×¢×¨×”: × × ×œ×¦×¨×£ ×™×“× ×™×ª ××ª ×§×•×‘×¥ ×”-PNG ××”×›×¤×ª×•×¨ "×¦×™×œ×•× ××¡×š".'
    ].join('\n');
    window.location.href = 'mailto:?subject='+encodeURIComponent(subject)+'&body='+encodeURIComponent(body);
  });

  // INIT
  refreshLabels(); calc();
})();
</script>
</body>
</html>
